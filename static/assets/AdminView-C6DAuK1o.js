import{d as _,r as m,s as H,H as k,e as u,t as c,g as e,D as S,o as i,_ as U,l as C,f as y,F as E,q as F,n as $,j,h as A,k as B,v as D,I as G,c as w}from"./index-DMTmS6cD.js";const J={class:"stats-tab"},K={key:0,class:"loading"},O={key:1,class:"error-message"},Q={key:2,class:"stats-grid"},W={class:"stat-card"},X={class:"stat-info"},Y={class:"stat-value"},Z={class:"stat-card"},ee={class:"stat-info"},te={class:"stat-value"},se={class:"stat-card"},ae={class:"stat-info"},oe={class:"stat-value"},ne={class:"stat-card"},ie={class:"stat-info"},le={class:"stat-value"},re=_({__name:"StatsTab",setup(d){const f=m(!1),l=m(""),n=m(null);H(()=>{r()});async function r(){f.value=!0,l.value="";try{const p=await k.get("/admin/stats");n.value=p.data}catch(p){l.value=p.response?.data?.message||"Failed to load stats"}finally{f.value=!1}}return(p,s)=>(i(),u("div",J,[f.value?(i(),u("div",K,"Loading stats...")):l.value?(i(),u("div",O,c(l.value),1)):(i(),u("div",Q,[e("div",W,[s[1]||(s[1]=S('<div class="stat-icon users" data-v-8d60de36><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-8d60de36><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" data-v-8d60de36></path><circle cx="9" cy="7" r="4" data-v-8d60de36></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87" data-v-8d60de36></path><path d="M16 3.13a4 4 0 0 1 0 7.75" data-v-8d60de36></path></svg></div>',1)),e("div",X,[e("div",Y,c(n.value?.total_users||0),1),s[0]||(s[0]=e("div",{class:"stat-label"},"Total Users",-1))])]),e("div",Z,[s[3]||(s[3]=e("div",{class:"stat-icon books"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),e("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})])],-1)),e("div",ee,[e("div",te,c(n.value?.total_books||0),1),s[2]||(s[2]=e("div",{class:"stat-label"},"Total Books",-1))])]),e("div",se,[s[5]||(s[5]=S('<div class="stat-icon downloads" data-v-8d60de36><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-8d60de36><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" data-v-8d60de36></path><polyline points="7 10 12 15 17 10" data-v-8d60de36></polyline><line x1="12" y1="15" x2="12" y2="3" data-v-8d60de36></line></svg></div>',1)),e("div",ae,[e("div",oe,c(n.value?.total_downloads||0),1),s[4]||(s[4]=e("div",{class:"stat-label"},"Total Downloads",-1))])]),e("div",ne,[s[7]||(s[7]=e("div",{class:"stat-icon active"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})])],-1)),e("div",ie,[e("div",le,c(n.value?.active_users||0),1),s[6]||(s[6]=e("div",{class:"stat-label"},"Active (24h)",-1))])])]))]))}}),de=U(re,[["__scopeId","data-v-8d60de36"]]),ue={class:"users-tab"},ve={class:"section-header"},ce={key:0,class:"loading"},fe={key:1,class:"error-message"},me={key:2,class:"users-table"},pe={class:"user-cell"},ye={class:"user-avatar"},ke={class:"action-buttons"},ge=["onClick"],$e=["onClick"],be={key:0,class:"pagination"},he=["disabled"],we=["disabled"],Ce=_({__name:"UsersTab",props:{users:{},loading:{type:Boolean},error:{},pagination:{}},emits:["create-user","edit-user","delete-user","load-users"],setup(d){function f(l){return l?new Date(typeof l=="string"?parseInt(l)*1e3:l*1e3).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}return(l,n)=>(i(),u("div",ue,[e("div",ve,[n[4]||(n[4]=e("h2",{class:"section-title"},"User Management",-1)),e("button",{class:"primary-button",onClick:n[0]||(n[0]=r=>l.$emit("create-user"))},[...n[3]||(n[3]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),C(" Create User ",-1)])])]),d.loading?(i(),u("div",ce,"Loading users...")):d.error?(i(),u("div",fe,c(d.error),1)):(i(),u("div",me,[e("table",null,[n[7]||(n[7]=e("thead",null,[e("tr",null,[e("th",null,"Username"),e("th",null,"Role"),e("th",null,"Created"),e("th",null,"Credits"),e("th",null,"Actions")])],-1)),e("tbody",null,[(i(!0),u(E,null,F(d.users,r=>(i(),u("tr",{key:r.id},[e("td",null,[e("div",pe,[e("div",ye,c(r.username.charAt(0).toUpperCase()),1),e("span",null,c(r.username),1)])]),e("td",null,[e("span",{class:$(["role-badge",r.user_role])},c(r.user_role),3)]),e("td",null,c(f(r.created_at)),1),e("td",null,c(r.request_credits||0),1),e("td",null,[e("div",ke,[e("button",{class:"icon-button",onClick:p=>l.$emit("edit-user",r),title:"Edit"},[...n[5]||(n[5]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,ge),e("button",{class:"icon-button danger",onClick:p=>l.$emit("delete-user",r),title:"Delete"},[...n[6]||(n[6]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,$e)])])]))),128))])]),d.pagination?(i(),u("div",be,[e("button",{disabled:d.pagination.offset===0,onClick:n[1]||(n[1]=r=>l.$emit("load-users",d.pagination.offset-d.pagination.limit))}," Previous ",8,he),e("span",null,c(d.pagination.offset+1)+" - "+c(Math.min(d.pagination.offset+d.pagination.limit,d.pagination.total))+" of "+c(d.pagination.total),1),e("button",{disabled:!d.pagination.has_next,onClick:n[2]||(n[2]=r=>l.$emit("load-users",d.pagination.offset+d.pagination.limit))}," Next ",8,we)])):y("",!0)]))]))}}),_e=U(Ce,[["__scopeId","data-v-6b06b736"]]),Ue={class:"invites-tab"},xe={class:"section-header"},Me={key:0,class:"loading"},Ie={key:1,class:"error-message"},Be={key:2,class:"invites-grid"},Se={class:"invite-header"},Te={class:"invite-date"},Ae={key:0,class:"invite-link-section"},De={class:"invite-url-container"},Ve=["value"],He=["onClick"],Ee={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Fe={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Le={key:1,class:"invite-info"},Ne={class:"info-row"},Re={key:0,class:"info-row"},qe=["onClick"],ze=_({__name:"InvitesTab",props:{invites:{},inviteData:{},loading:{type:Boolean},error:{}},emits:["create-invite","revoke-invite"],setup(d){const f=m({}),l=m(null);function n(s){return`${window.location.origin}/register?token=${s}`}function r(s){const t=n(s),a=f.value[s];a&&(a.select(),a.setSelectionRange(0,99999)),navigator.clipboard.writeText(t).then(()=>{l.value=s,setTimeout(()=>{l.value=null},2e3)})}function p(s){return s?new Date(typeof s=="string"?parseInt(s)*1e3:s*1e3).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}return(s,t)=>(i(),u("div",Ue,[e("div",xe,[t[2]||(t[2]=e("h2",{class:"section-title"},"Invite Management",-1)),e("button",{class:"primary-button",onClick:t[0]||(t[0]=a=>s.$emit("create-invite"))},[...t[1]||(t[1]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),C(" Create Invite ",-1)])])]),d.loading?(i(),u("div",Me,"Loading invites...")):d.error?(i(),u("div",Ie,c(d.error),1)):(i(),u("div",Be,[(i(!0),u(E,null,F(d.invites.filter(a=>!a.revoked_at),a=>(i(),u("div",{key:a.token,class:"invite-card"},[e("div",Se,[e("span",{class:$(["invite-status",{used:a.used_at}])},c(a.used_at?"Used":"Active"),3),e("span",Te,c(p(a.created_at)),1)]),!a.used_at&&!a.revoked_at?(i(),u("div",Ae,[t[5]||(t[5]=e("label",{class:"invite-label"},"Invite URL",-1)),e("div",De,[e("input",{value:n(a.token),readonly:"",class:"invite-url-input",ref_for:!0,ref:g=>{g&&(f.value[a.token]=g)}},null,8,Ve),e("button",{class:$(["copy-button",{copied:l.value===a.token}]),onClick:g=>r(a.token)},[l.value!==a.token?(i(),u("svg",Ee,[...t[3]||(t[3]=[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),e("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])):(i(),u("svg",Fe,[...t[4]||(t[4]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])),C(" "+c(l.value===a.token?"Copied!":"Copy"),1)],10,He)])])):y("",!0),a.invitee_username?(i(),u("div",Le,[e("div",Ne,[t[6]||(t[6]=e("span",{class:"info-label"},"Used by:",-1)),e("strong",null,c(a.invitee_username),1)]),a.used_at?(i(),u("div",Re,[t[7]||(t[7]=e("span",{class:"info-label"},"Used on:",-1)),e("span",null,c(p(a.used_at)),1)])):y("",!0)])):y("",!0),!a.used_at&&!a.revoked_at?(i(),u("button",{key:2,class:"revoke-button",onClick:g=>s.$emit("revoke-invite",a.token)}," Revoke Invite ",8,qe)):y("",!0)]))),128))]))]))}}),Pe=U(ze,[["__scopeId","data-v-4f714ed8"]]),je={class:"modal"},Ge={class:"form-group"},Je={key:0,class:"form-group"},Ke={class:"form-group"},Oe={class:"modal-actions"},Qe={type:"submit",class:"primary-button"},We=_({__name:"UserModal",props:{user:{},isEdit:{type:Boolean}},emits:["close","submit"],setup(d,{emit:f}){const l=d,n=f,r=m({username:l.user?.username||"",password:"",role:l.user?.user_role||l.user?.role||"user"});j(()=>l.user,s=>{s&&(r.value={username:s.username||"",password:"",role:s.user_role||s.role||"user"})},{immediate:!0});function p(){n("submit",r.value)}return(s,t)=>(i(),u("div",{class:"modal-overlay",onClick:t[4]||(t[4]=A(a=>s.$emit("close"),["self"]))},[e("div",je,[e("h2",null,c(d.isEdit?"Edit User":"Create New User"),1),e("form",{onSubmit:A(p,["prevent"])},[e("div",Ge,[t[5]||(t[5]=e("label",null,"Username",-1)),B(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>r.value.username=a),type:"text",required:""},null,512),[[D,r.value.username]])]),d.isEdit?y("",!0):(i(),u("div",Je,[t[6]||(t[6]=e("label",null,"Password",-1)),B(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>r.value.password=a),type:"password",required:""},null,512),[[D,r.value.password]])])),e("div",Ke,[t[8]||(t[8]=e("label",null,"Role",-1)),B(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>r.value.role=a)},[...t[7]||(t[7]=[e("option",{value:"user"},"User",-1),e("option",{value:"admin"},"Admin",-1)])],512),[[G,r.value.role]])]),e("div",Oe,[e("button",{type:"button",class:"secondary-button",onClick:t[3]||(t[3]=a=>s.$emit("close"))},"Cancel"),e("button",Qe,c(d.isEdit?"Update":"Create"),1)])],32)])]))}}),V=U(We,[["__scopeId","data-v-2d29d1bd"]]),Xe={class:"admin-view"},Ye={class:"content"},Ze={class:"header"},et={class:"tabs"},tt={class:"tab-content"},st=_({__name:"AdminView",setup(d){const f=m("stats"),l=m([]),n=m(!1),r=m(""),p=m(null),s=m(!1),t=m(!1),a=m(null),g=m([]),T=m(null),x=m(!1),M=m("");H(()=>{b(),I()});async function b(v=0){n.value=!0,r.value="";try{const o=await k.get(`/admin/users?limit=20&offset=${v}`);l.value=o.data.users||[],p.value=o.data.pagination}catch(o){r.value=o.response?.data?.message||"Failed to load users"}finally{n.value=!1}}async function I(){x.value=!0,M.value="";try{const v=await k.get("/invites");T.value=v.data,g.value=v.data.invites||[]}catch(v){M.value=v.response?.data?.message||"Failed to load invites"}finally{x.value=!1}}async function L(v){try{await k.post("/admin/users",v),s.value=!1,b()}catch(o){alert(o.response?.data?.message||"Failed to create user")}}function N(v){a.value={...v},t.value=!0}async function R(v){try{await k.put(`/admin/users/${a.value.id}`,{username:v.username,role:v.role}),t.value=!1,a.value=null,b()}catch(o){alert(o.response?.data?.message||"Failed to update user")}}async function q(v){if(confirm(`Are you sure you want to delete user "${v.username}"?`))try{await k.delete(`/admin/users/${v.id}`),b()}catch(o){alert(o.response?.data?.message||"Failed to delete user")}}async function z(){try{const v=await k.post("/invites");I()}catch(v){alert(v.response?.data?.message||"Failed to create invite")}}async function P(v){if(confirm("Are you sure you want to revoke this invite?"))try{await k.post(`/invites/${v}/revoke`),I()}catch(o){alert(o.response?.data?.message||"Failed to revoke invite")}}return(v,o)=>(i(),u("div",Xe,[e("main",Ye,[e("div",Ze,[o[9]||(o[9]=e("div",null,[e("h1",{class:"page-title"},"Admin Panel"),e("p",{class:"page-subtitle"},"Manage users, invites, and system settings")],-1)),e("div",et,[e("button",{class:$(["tab",{active:f.value==="stats"}]),onClick:o[0]||(o[0]=h=>f.value="stats")},[...o[6]||(o[6]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),e("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),e("line",{x1:"6",y1:"20",x2:"6",y2:"14"})],-1),C(" Stats ",-1)])],2),e("button",{class:$(["tab",{active:f.value==="users"}]),onClick:o[1]||(o[1]=h=>f.value="users")},[...o[7]||(o[7]=[S('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-5fcc3343><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" data-v-5fcc3343></path><circle cx="9" cy="7" r="4" data-v-5fcc3343></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87" data-v-5fcc3343></path><path d="M16 3.13a4 4 0 0 1 0 7.75" data-v-5fcc3343></path></svg> Users ',2)])],2),e("button",{class:$(["tab",{active:f.value==="invites"}]),onClick:o[2]||(o[2]=h=>f.value="invites")},[...o[8]||(o[8]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})],-1),C(" Invites ",-1)])],2)])]),e("div",tt,[f.value==="stats"?(i(),w(de,{key:0})):y("",!0),f.value==="users"?(i(),w(_e,{key:1,users:l.value,loading:n.value,error:r.value,pagination:p.value,onCreateUser:o[3]||(o[3]=h=>s.value=!0),onEditUser:N,onDeleteUser:q,onLoadUsers:b},null,8,["users","loading","error","pagination"])):y("",!0),f.value==="invites"?(i(),w(Pe,{key:2,invites:g.value,"invite-data":T.value,loading:x.value,error:M.value,onCreateInvite:z,onRevokeInvite:P},null,8,["invites","invite-data","loading","error"])):y("",!0)])]),s.value?(i(),w(V,{key:0,onClose:o[4]||(o[4]=h=>s.value=!1),onSubmit:L})):y("",!0),t.value?(i(),w(V,{key:1,user:a.value,"is-edit":!0,onClose:o[5]||(o[5]=h=>t.value=!1),onSubmit:R},null,8,["user"])):y("",!0)]))}}),ot=U(st,[["__scopeId","data-v-5fcc3343"]]);export{ot as default};
